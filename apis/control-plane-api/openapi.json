{"openapi":"3.1.0","info":{"title":"STOA Control-Plane API","description":"\n## STOA Control-Plane API\n\nMulti-tenant API Management Control Plane with GitOps integration.\n\n### Features\n\n- **Multi-tenant Management**: Create and manage isolated API tenants\n- **API Lifecycle**: Full CRUD operations for APIs with versioning\n- **GitOps Integration**: Automatic sync with GitLab repositories\n- **Event-Driven Architecture**: Kafka/Redpanda message bus for async operations\n- **Pipeline Monitoring**: End-to-end tracing of deployments\n- **RBAC**: Role-based access control via Keycloak\n\n### Changelog\n\n#### v2.0.0 (Current)\n- Added Pipeline Tracing (`/v1/traces`) for end-to-end monitoring\n- Added GitLab Webhook integration (`/webhooks/gitlab`)\n- Added Kafka integration for event-driven deployments\n- Added AWX integration for automated Gateway deployments\n\n#### v1.0.0\n- Initial release with tenant, API, and application management\n- Basic deployment endpoints\n- Git operations (commits, merge requests)\n\n### Authentication\n\nAll endpoints require a valid JWT token from Keycloak (realm: `apim`).\nInclude the token in the `Authorization: Bearer <token>` header.\n","contact":{"name":"CAB Ingenierie","email":"admin@cab-i.com"},"license":{"name":"Proprietary"},"version":"2.0.0"},"paths":{"/v1/tenants":{"get":{"tags":["Tenants"],"summary":"List Tenants","description":"List all tenants (CPI Admin) or own tenant (others)","operationId":"list_tenants_v1_tenants_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"items":{"$ref":"#/components/schemas/TenantResponse"},"type":"array","title":"Response List Tenants V1 Tenants Get"}}}}},"security":[{"HTTPBearer":[]}]},"post":{"tags":["Tenants"],"summary":"Create Tenant","description":"Create a new tenant (CPI Admin only)","operationId":"create_tenant_v1_tenants_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/TenantCreate"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TenantResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"HTTPBearer":[]}]}},"/v1/tenants/{tenant_id}":{"get":{"tags":["Tenants"],"summary":"Get Tenant","description":"Get tenant by ID","operationId":"get_tenant_v1_tenants__tenant_id__get","security":[{"HTTPBearer":[]}],"parameters":[{"name":"tenant_id","in":"path","required":true,"schema":{"type":"string","title":"Tenant Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TenantResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"put":{"tags":["Tenants"],"summary":"Update Tenant","description":"Update tenant","operationId":"update_tenant_v1_tenants__tenant_id__put","security":[{"HTTPBearer":[]}],"parameters":[{"name":"tenant_id","in":"path","required":true,"schema":{"type":"string","title":"Tenant Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/TenantCreate"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TenantResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"delete":{"tags":["Tenants"],"summary":"Delete Tenant","description":"Delete tenant (CPI Admin only)","operationId":"delete_tenant_v1_tenants__tenant_id__delete","security":[{"HTTPBearer":[]}],"parameters":[{"name":"tenant_id","in":"path","required":true,"schema":{"type":"string","title":"Tenant Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/v1/tenants/{tenant_id}/apis":{"get":{"tags":["APIs"],"summary":"List Apis","description":"List all APIs for a tenant","operationId":"list_apis_v1_tenants__tenant_id__apis_get","security":[{"HTTPBearer":[]}],"parameters":[{"name":"tenant_id","in":"path","required":true,"schema":{"type":"string","title":"Tenant Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/APIResponse"},"title":"Response List Apis V1 Tenants  Tenant Id  Apis Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"post":{"tags":["APIs"],"summary":"Create Api","description":"Create a new API","operationId":"create_api_v1_tenants__tenant_id__apis_post","security":[{"HTTPBearer":[]}],"parameters":[{"name":"tenant_id","in":"path","required":true,"schema":{"type":"string","title":"Tenant Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/APICreate"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/APIResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/v1/tenants/{tenant_id}/apis/{api_id}":{"get":{"tags":["APIs"],"summary":"Get Api","description":"Get API by ID","operationId":"get_api_v1_tenants__tenant_id__apis__api_id__get","security":[{"HTTPBearer":[]}],"parameters":[{"name":"tenant_id","in":"path","required":true,"schema":{"type":"string","title":"Tenant Id"}},{"name":"api_id","in":"path","required":true,"schema":{"type":"string","title":"Api Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/APIResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"put":{"tags":["APIs"],"summary":"Update Api","description":"Update API","operationId":"update_api_v1_tenants__tenant_id__apis__api_id__put","security":[{"HTTPBearer":[]}],"parameters":[{"name":"tenant_id","in":"path","required":true,"schema":{"type":"string","title":"Tenant Id"}},{"name":"api_id","in":"path","required":true,"schema":{"type":"string","title":"Api Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/APICreate"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/APIResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"delete":{"tags":["APIs"],"summary":"Delete Api","description":"Delete API","operationId":"delete_api_v1_tenants__tenant_id__apis__api_id__delete","security":[{"HTTPBearer":[]}],"parameters":[{"name":"tenant_id","in":"path","required":true,"schema":{"type":"string","title":"Tenant Id"}},{"name":"api_id","in":"path","required":true,"schema":{"type":"string","title":"Api Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/v1/tenants/{tenant_id}/applications":{"get":{"tags":["Applications"],"summary":"List Applications","description":"List all applications for a tenant","operationId":"list_applications_v1_tenants__tenant_id__applications_get","security":[{"HTTPBearer":[]}],"parameters":[{"name":"tenant_id","in":"path","required":true,"schema":{"type":"string","title":"Tenant Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/ApplicationResponse"},"title":"Response List Applications V1 Tenants  Tenant Id  Applications Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"post":{"tags":["Applications"],"summary":"Create Application","description":"Create a new application (Keycloak client)","operationId":"create_application_v1_tenants__tenant_id__applications_post","security":[{"HTTPBearer":[]}],"parameters":[{"name":"tenant_id","in":"path","required":true,"schema":{"type":"string","title":"Tenant Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ApplicationCreate"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ApplicationResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/v1/tenants/{tenant_id}/applications/{app_id}":{"get":{"tags":["Applications"],"summary":"Get Application","description":"Get application by ID","operationId":"get_application_v1_tenants__tenant_id__applications__app_id__get","security":[{"HTTPBearer":[]}],"parameters":[{"name":"tenant_id","in":"path","required":true,"schema":{"type":"string","title":"Tenant Id"}},{"name":"app_id","in":"path","required":true,"schema":{"type":"string","title":"App Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ApplicationResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"put":{"tags":["Applications"],"summary":"Update Application","description":"Update application","operationId":"update_application_v1_tenants__tenant_id__applications__app_id__put","security":[{"HTTPBearer":[]}],"parameters":[{"name":"tenant_id","in":"path","required":true,"schema":{"type":"string","title":"Tenant Id"}},{"name":"app_id","in":"path","required":true,"schema":{"type":"string","title":"App Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ApplicationCreate"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ApplicationResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"delete":{"tags":["Applications"],"summary":"Delete Application","description":"Delete application","operationId":"delete_application_v1_tenants__tenant_id__applications__app_id__delete","security":[{"HTTPBearer":[]}],"parameters":[{"name":"tenant_id","in":"path","required":true,"schema":{"type":"string","title":"Tenant Id"}},{"name":"app_id","in":"path","required":true,"schema":{"type":"string","title":"App Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/v1/tenants/{tenant_id}/applications/{app_id}/regenerate-secret":{"post":{"tags":["Applications"],"summary":"Regenerate Secret","description":"Regenerate application client secret","operationId":"regenerate_secret_v1_tenants__tenant_id__applications__app_id__regenerate_secret_post","security":[{"HTTPBearer":[]}],"parameters":[{"name":"tenant_id","in":"path","required":true,"schema":{"type":"string","title":"Tenant Id"}},{"name":"app_id","in":"path","required":true,"schema":{"type":"string","title":"App Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ApplicationCredentials"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/v1/tenants/{tenant_id}/applications/{app_id}/subscribe/{api_id}":{"post":{"tags":["Applications"],"summary":"Subscribe To Api","description":"Subscribe application to an API","operationId":"subscribe_to_api_v1_tenants__tenant_id__applications__app_id__subscribe__api_id__post","security":[{"HTTPBearer":[]}],"parameters":[{"name":"tenant_id","in":"path","required":true,"schema":{"type":"string","title":"Tenant Id"}},{"name":"app_id","in":"path","required":true,"schema":{"type":"string","title":"App Id"}},{"name":"api_id","in":"path","required":true,"schema":{"type":"string","title":"Api Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"delete":{"tags":["Applications"],"summary":"Unsubscribe From Api","description":"Unsubscribe application from an API","operationId":"unsubscribe_from_api_v1_tenants__tenant_id__applications__app_id__subscribe__api_id__delete","security":[{"HTTPBearer":[]}],"parameters":[{"name":"tenant_id","in":"path","required":true,"schema":{"type":"string","title":"Tenant Id"}},{"name":"app_id","in":"path","required":true,"schema":{"type":"string","title":"App Id"}},{"name":"api_id","in":"path","required":true,"schema":{"type":"string","title":"Api Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/v1/tenants/{tenant_id}/deployments":{"get":{"tags":["Deployments"],"summary":"List Deployments","description":"List deployment history","operationId":"list_deployments_v1_tenants__tenant_id__deployments_get","security":[{"HTTPBearer":[]}],"parameters":[{"name":"tenant_id","in":"path","required":true,"schema":{"type":"string","title":"Tenant Id"}},{"name":"api_id","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Api Id"}},{"name":"environment","in":"query","required":false,"schema":{"anyOf":[{"$ref":"#/components/schemas/Environment"},{"type":"null"}],"title":"Environment"}},{"name":"limit","in":"query","required":false,"schema":{"type":"integer","default":50,"title":"Limit"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/DeploymentResponse"},"title":"Response List Deployments V1 Tenants  Tenant Id  Deployments Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"post":{"tags":["Deployments"],"summary":"Create Deployment","description":"Deploy an API to an environment.\n\nThis will:\n1. Validate the API exists and is deployable\n2. Create a deploy-request event in Kafka\n3. AWX will pick up the event and execute the deployment\n4. Status updates will be streamed via SSE","operationId":"create_deployment_v1_tenants__tenant_id__deployments_post","security":[{"HTTPBearer":[]}],"parameters":[{"name":"tenant_id","in":"path","required":true,"schema":{"type":"string","title":"Tenant Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/DeploymentRequest"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/DeploymentResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/v1/tenants/{tenant_id}/deployments/{deployment_id}":{"get":{"tags":["Deployments"],"summary":"Get Deployment","description":"Get deployment details","operationId":"get_deployment_v1_tenants__tenant_id__deployments__deployment_id__get","security":[{"HTTPBearer":[]}],"parameters":[{"name":"tenant_id","in":"path","required":true,"schema":{"type":"string","title":"Tenant Id"}},{"name":"deployment_id","in":"path","required":true,"schema":{"type":"string","title":"Deployment Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/DeploymentResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/v1/tenants/{tenant_id}/deployments/{deployment_id}/rollback":{"post":{"tags":["Deployments"],"summary":"Rollback Deployment","description":"Rollback a deployment to a previous version","operationId":"rollback_deployment_v1_tenants__tenant_id__deployments__deployment_id__rollback_post","security":[{"HTTPBearer":[]}],"parameters":[{"name":"tenant_id","in":"path","required":true,"schema":{"type":"string","title":"Tenant Id"}},{"name":"deployment_id","in":"path","required":true,"schema":{"type":"string","title":"Deployment Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/RollbackRequest"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/DeploymentResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/v1/tenants/{tenant_id}/deployments/{deployment_id}/logs":{"get":{"tags":["Deployments"],"summary":"Get Deployment Logs","description":"Get deployment logs from AWX","operationId":"get_deployment_logs_v1_tenants__tenant_id__deployments__deployment_id__logs_get","security":[{"HTTPBearer":[]}],"parameters":[{"name":"tenant_id","in":"path","required":true,"schema":{"type":"string","title":"Tenant Id"}},{"name":"deployment_id","in":"path","required":true,"schema":{"type":"string","title":"Deployment Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/v1/tenants/{tenant_id}/deployments/environments/{environment}/status":{"get":{"tags":["Deployments"],"summary":"Get Environment Status","description":"Get status of all APIs deployed in an environment","operationId":"get_environment_status_v1_tenants__tenant_id__deployments_environments__environment__status_get","security":[{"HTTPBearer":[]}],"parameters":[{"name":"tenant_id","in":"path","required":true,"schema":{"type":"string","title":"Tenant Id"}},{"name":"environment","in":"path","required":true,"schema":{"$ref":"#/components/schemas/Environment"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/v1/tenants/{tenant_id}/git/commits":{"get":{"tags":["Git"],"summary":"List Commits","description":"List recent commits for tenant repository","operationId":"list_commits_v1_tenants__tenant_id__git_commits_get","security":[{"HTTPBearer":[]}],"parameters":[{"name":"tenant_id","in":"path","required":true,"schema":{"type":"string","title":"Tenant Id"}},{"name":"path","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Path"}},{"name":"limit","in":"query","required":false,"schema":{"type":"integer","default":20,"title":"Limit"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/CommitInfo"},"title":"Response List Commits V1 Tenants  Tenant Id  Git Commits Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/v1/tenants/{tenant_id}/git/files/{file_path}":{"get":{"tags":["Git"],"summary":"Get File","description":"Get file content from GitLab","operationId":"get_file_v1_tenants__tenant_id__git_files__file_path__get","security":[{"HTTPBearer":[]}],"parameters":[{"name":"tenant_id","in":"path","required":true,"schema":{"type":"string","title":"Tenant Id"}},{"name":"file_path","in":"path","required":true,"schema":{"type":"string","title":"File Path"}},{"name":"ref","in":"query","required":false,"schema":{"type":"string","default":"main","title":"Ref"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"post":{"tags":["Git"],"summary":"Create Or Update File","description":"Create or update a file in GitLab","operationId":"create_or_update_file_v1_tenants__tenant_id__git_files__file_path__post","security":[{"HTTPBearer":[]}],"parameters":[{"name":"tenant_id","in":"path","required":true,"schema":{"type":"string","title":"Tenant Id"}},{"name":"file_path","in":"path","required":true,"schema":{"type":"string","title":"File Path"}},{"name":"branch","in":"query","required":false,"schema":{"type":"string","default":"main","title":"Branch"}},{"name":"commit_message","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Commit Message"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/FileContent"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"delete":{"tags":["Git"],"summary":"Delete File","description":"Delete a file from GitLab","operationId":"delete_file_v1_tenants__tenant_id__git_files__file_path__delete","security":[{"HTTPBearer":[]}],"parameters":[{"name":"tenant_id","in":"path","required":true,"schema":{"type":"string","title":"Tenant Id"}},{"name":"file_path","in":"path","required":true,"schema":{"type":"string","title":"File Path"}},{"name":"branch","in":"query","required":false,"schema":{"type":"string","default":"main","title":"Branch"}},{"name":"commit_message","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Commit Message"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/v1/tenants/{tenant_id}/git/tree":{"get":{"tags":["Git"],"summary":"Get Tree","description":"Get directory tree from GitLab","operationId":"get_tree_v1_tenants__tenant_id__git_tree_get","security":[{"HTTPBearer":[]}],"parameters":[{"name":"tenant_id","in":"path","required":true,"schema":{"type":"string","title":"Tenant Id"}},{"name":"path","in":"query","required":false,"schema":{"type":"string","default":"","title":"Path"}},{"name":"ref","in":"query","required":false,"schema":{"type":"string","default":"main","title":"Ref"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/v1/tenants/{tenant_id}/git/merge-requests":{"get":{"tags":["Git"],"summary":"List Merge Requests","description":"List merge requests","operationId":"list_merge_requests_v1_tenants__tenant_id__git_merge_requests_get","security":[{"HTTPBearer":[]}],"parameters":[{"name":"tenant_id","in":"path","required":true,"schema":{"type":"string","title":"Tenant Id"}},{"name":"state","in":"query","required":false,"schema":{"type":"string","default":"opened","title":"State"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/MergeRequestResponse"},"title":"Response List Merge Requests V1 Tenants  Tenant Id  Git Merge Requests Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"post":{"tags":["Git"],"summary":"Create Merge Request","description":"Create a merge request","operationId":"create_merge_request_v1_tenants__tenant_id__git_merge_requests_post","security":[{"HTTPBearer":[]}],"parameters":[{"name":"tenant_id","in":"path","required":true,"schema":{"type":"string","title":"Tenant Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/MergeRequestCreate"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/MergeRequestResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/v1/tenants/{tenant_id}/git/merge-requests/{mr_iid}/merge":{"post":{"tags":["Git"],"summary":"Merge Request","description":"Merge a merge request","operationId":"merge_request_v1_tenants__tenant_id__git_merge_requests__mr_iid__merge_post","security":[{"HTTPBearer":[]}],"parameters":[{"name":"tenant_id","in":"path","required":true,"schema":{"type":"string","title":"Tenant Id"}},{"name":"mr_iid","in":"path","required":true,"schema":{"type":"integer","title":"Mr Iid"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/v1/tenants/{tenant_id}/git/branches":{"get":{"tags":["Git"],"summary":"List Branches","description":"List branches","operationId":"list_branches_v1_tenants__tenant_id__git_branches_get","security":[{"HTTPBearer":[]}],"parameters":[{"name":"tenant_id","in":"path","required":true,"schema":{"type":"string","title":"Tenant Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"post":{"tags":["Git"],"summary":"Create Branch","description":"Create a new branch","operationId":"create_branch_v1_tenants__tenant_id__git_branches_post","security":[{"HTTPBearer":[]}],"parameters":[{"name":"tenant_id","in":"path","required":true,"schema":{"type":"string","title":"Tenant Id"}},{"name":"branch_name","in":"query","required":true,"schema":{"type":"string","title":"Branch Name"}},{"name":"ref","in":"query","required":false,"schema":{"type":"string","default":"main","title":"Ref"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/v1/events/stream/{tenant_id}":{"get":{"tags":["Events"],"summary":"Stream Events","description":"Stream real-time events for a tenant via Server-Sent Events.\n\nConnect to this endpoint to receive real-time updates about:\n- API lifecycle events (created, updated, deleted)\n- Deployment status changes\n- Application events\n\nQuery params:\n- event_types: Comma-separated list of event types to filter (optional)\n\nExample:\n```\nconst eventSource = new EventSource('/v1/events/stream/tenant-123?event_types=deploy-progress,deploy-success');\neventSource.onmessage = (event) => {\n    console.log(event.data);\n};\n```","operationId":"stream_events_v1_events_stream__tenant_id__get","security":[{"HTTPBearer":[]}],"parameters":[{"name":"tenant_id","in":"path","required":true,"schema":{"type":"string","title":"Tenant Id"}},{"name":"event_types","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Event Types"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/v1/events/stream/global":{"get":{"tags":["Events"],"summary":"Stream Global Events","description":"Stream all events (for cpi-admin users only).\n\nThis endpoint streams events from all tenants.\nOnly users with cpi-admin role can access this.","operationId":"stream_global_events_v1_events_stream_global_get","security":[{"HTTPBearer":[]}],"parameters":[{"name":"event_types","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Event Types"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/v1/events/history/{tenant_id}":{"get":{"tags":["Events"],"summary":"Get Event History","description":"Get historical events from database/Kafka","operationId":"get_event_history_v1_events_history__tenant_id__get","security":[{"HTTPBearer":[]}],"parameters":[{"name":"tenant_id","in":"path","required":true,"schema":{"type":"string","title":"Tenant Id"}},{"name":"event_type","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Event Type"}},{"name":"limit","in":"query","required":false,"schema":{"type":"integer","default":100,"title":"Limit"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/webhooks/gitlab":{"post":{"tags":["Webhooks"],"summary":"Gitlab Webhook","description":"Handle GitLab webhooks for GitOps with full pipeline tracing.","operationId":"gitlab_webhook_webhooks_gitlab_post","parameters":[{"name":"X-Gitlab-Token","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"X-Gitlab-Token"}},{"name":"X-Gitlab-Event","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"X-Gitlab-Event"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/webhooks/gitlab/health":{"get":{"tags":["Webhooks"],"summary":"Webhook Health","description":"Health check for GitLab webhook endpoint","operationId":"webhook_health_webhooks_gitlab_health_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/v1/traces":{"get":{"tags":["traces"],"summary":"List Traces","description":"List recent pipeline traces with optional filtering.\n\nReturns summaries for efficient list display.","operationId":"list_traces_v1_traces_get","parameters":[{"name":"limit","in":"query","required":false,"schema":{"type":"integer","maximum":200,"minimum":1,"default":50,"title":"Limit"}},{"name":"tenant_id","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Tenant Id"}},{"name":"status","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Status"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/v1/traces/stats":{"get":{"tags":["traces"],"summary":"Get Trace Stats","description":"Get pipeline trace statistics.\n\nReturns aggregated metrics about pipeline executions.","operationId":"get_trace_stats_v1_traces_stats_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/v1/traces/live":{"get":{"tags":["traces"],"summary":"Get Live Traces","description":"Get currently running traces (in_progress status).\n\nUseful for real-time monitoring dashboards.","operationId":"get_live_traces_v1_traces_live_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/v1/traces/{trace_id}":{"get":{"tags":["traces"],"summary":"Get Trace","description":"Get detailed information about a specific trace.\n\nIncludes all steps with timing and error details.","operationId":"get_trace_v1_traces__trace_id__get","parameters":[{"name":"trace_id","in":"path","required":true,"schema":{"type":"string","title":"Trace Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/v1/traces/{trace_id}/timeline":{"get":{"tags":["traces"],"summary":"Get Trace Timeline","description":"Get a timeline view of a trace suitable for visualization.\n\nReturns steps in a format optimized for timeline rendering.","operationId":"get_trace_timeline_v1_traces__trace_id__timeline_get","parameters":[{"name":"trace_id","in":"path","required":true,"schema":{"type":"string","title":"Trace Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/health":{"get":{"summary":"Health","operationId":"health_health_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/":{"get":{"summary":"Root","operationId":"root__get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}}},"components":{"schemas":{"APICreate":{"properties":{"name":{"type":"string","title":"Name"},"display_name":{"type":"string","title":"Display Name"},"version":{"type":"string","title":"Version"},"description":{"type":"string","title":"Description","default":""},"backend_url":{"type":"string","title":"Backend Url"},"openapi_spec":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Openapi Spec"}},"type":"object","required":["name","display_name","version","backend_url"],"title":"APICreate"},"APIResponse":{"properties":{"id":{"type":"string","title":"Id"},"tenant_id":{"type":"string","title":"Tenant Id"},"name":{"type":"string","title":"Name"},"display_name":{"type":"string","title":"Display Name"},"version":{"type":"string","title":"Version"},"description":{"type":"string","title":"Description"},"backend_url":{"type":"string","title":"Backend Url"},"status":{"type":"string","title":"Status","default":"draft"},"deployed_dev":{"type":"boolean","title":"Deployed Dev","default":false},"deployed_staging":{"type":"boolean","title":"Deployed Staging","default":false}},"type":"object","required":["id","tenant_id","name","display_name","version","description","backend_url"],"title":"APIResponse"},"ApplicationCreate":{"properties":{"name":{"type":"string","title":"Name"},"display_name":{"type":"string","title":"Display Name"},"description":{"type":"string","title":"Description","default":""},"redirect_uris":{"items":{"type":"string"},"type":"array","title":"Redirect Uris","default":[]},"api_subscriptions":{"items":{"type":"string"},"type":"array","title":"Api Subscriptions","default":[]}},"type":"object","required":["name","display_name"],"title":"ApplicationCreate"},"ApplicationCredentials":{"properties":{"client_id":{"type":"string","title":"Client Id"},"client_secret":{"type":"string","title":"Client Secret"}},"type":"object","required":["client_id","client_secret"],"title":"ApplicationCredentials"},"ApplicationResponse":{"properties":{"id":{"type":"string","title":"Id"},"tenant_id":{"type":"string","title":"Tenant Id"},"name":{"type":"string","title":"Name"},"display_name":{"type":"string","title":"Display Name"},"description":{"type":"string","title":"Description"},"client_id":{"type":"string","title":"Client Id"},"status":{"type":"string","title":"Status","default":"pending"},"api_subscriptions":{"items":{"type":"string"},"type":"array","title":"Api Subscriptions","default":[]},"created_at":{"type":"string","title":"Created At"},"updated_at":{"type":"string","title":"Updated At"}},"type":"object","required":["id","tenant_id","name","display_name","description","client_id","created_at","updated_at"],"title":"ApplicationResponse"},"CommitInfo":{"properties":{"sha":{"type":"string","title":"Sha"},"message":{"type":"string","title":"Message"},"author":{"type":"string","title":"Author"},"date":{"type":"string","title":"Date"}},"type":"object","required":["sha","message","author","date"],"title":"CommitInfo"},"DeploymentRequest":{"properties":{"api_id":{"type":"string","title":"Api Id"},"environment":{"$ref":"#/components/schemas/Environment"},"version":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Version"}},"type":"object","required":["api_id","environment"],"title":"DeploymentRequest"},"DeploymentResponse":{"properties":{"id":{"type":"string","title":"Id"},"tenant_id":{"type":"string","title":"Tenant Id"},"api_id":{"type":"string","title":"Api Id"},"api_name":{"type":"string","title":"Api Name"},"environment":{"$ref":"#/components/schemas/Environment"},"version":{"type":"string","title":"Version"},"status":{"$ref":"#/components/schemas/DeploymentStatus"},"started_at":{"type":"string","title":"Started At"},"completed_at":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Completed At"},"deployed_by":{"type":"string","title":"Deployed By"},"awx_job_id":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Awx Job Id"},"error_message":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Error Message"}},"type":"object","required":["id","tenant_id","api_id","api_name","environment","version","status","started_at","deployed_by"],"title":"DeploymentResponse"},"DeploymentStatus":{"type":"string","enum":["pending","in_progress","success","failed","rolled_back"],"title":"DeploymentStatus"},"Environment":{"type":"string","enum":["dev","staging"],"title":"Environment"},"FileContent":{"properties":{"path":{"type":"string","title":"Path"},"content":{"type":"string","title":"Content"},"encoding":{"type":"string","title":"Encoding","default":"text"}},"type":"object","required":["path","content"],"title":"FileContent"},"HTTPValidationError":{"properties":{"detail":{"items":{"$ref":"#/components/schemas/ValidationError"},"type":"array","title":"Detail"}},"type":"object","title":"HTTPValidationError"},"MergeRequestCreate":{"properties":{"title":{"type":"string","title":"Title"},"description":{"type":"string","title":"Description"},"source_branch":{"type":"string","title":"Source Branch"},"target_branch":{"type":"string","title":"Target Branch","default":"main"}},"type":"object","required":["title","description","source_branch"],"title":"MergeRequestCreate"},"MergeRequestResponse":{"properties":{"id":{"type":"integer","title":"Id"},"iid":{"type":"integer","title":"Iid"},"title":{"type":"string","title":"Title"},"description":{"type":"string","title":"Description"},"state":{"type":"string","title":"State"},"source_branch":{"type":"string","title":"Source Branch"},"target_branch":{"type":"string","title":"Target Branch"},"web_url":{"type":"string","title":"Web Url"},"created_at":{"type":"string","title":"Created At"},"author":{"type":"string","title":"Author"}},"type":"object","required":["id","iid","title","description","state","source_branch","target_branch","web_url","created_at","author"],"title":"MergeRequestResponse"},"RollbackRequest":{"properties":{"target_version":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Target Version"}},"type":"object","title":"RollbackRequest"},"TenantCreate":{"properties":{"name":{"type":"string","title":"Name"},"display_name":{"type":"string","title":"Display Name"},"description":{"type":"string","title":"Description","default":""},"owner_email":{"type":"string","title":"Owner Email"}},"type":"object","required":["name","display_name","owner_email"],"title":"TenantCreate"},"TenantResponse":{"properties":{"id":{"type":"string","title":"Id"},"name":{"type":"string","title":"Name"},"display_name":{"type":"string","title":"Display Name"},"description":{"type":"string","title":"Description"},"owner_email":{"type":"string","title":"Owner Email"},"api_count":{"type":"integer","title":"Api Count","default":0},"application_count":{"type":"integer","title":"Application Count","default":0}},"type":"object","required":["id","name","display_name","description","owner_email"],"title":"TenantResponse"},"ValidationError":{"properties":{"loc":{"items":{"anyOf":[{"type":"string"},{"type":"integer"}]},"type":"array","title":"Location"},"msg":{"type":"string","title":"Message"},"type":{"type":"string","title":"Error Type"}},"type":"object","required":["loc","msg","type"],"title":"ValidationError"}},"securitySchemes":{"HTTPBearer":{"type":"http","scheme":"bearer"}}},"tags":[{"name":"tenants","description":"Tenant management operations"},{"name":"apis","description":"API lifecycle management"},{"name":"applications","description":"Application and subscription management"},{"name":"deployments","description":"Deployment operations and status"},{"name":"git","description":"GitLab integration (commits, MRs, files)"},{"name":"events","description":"Real-time event streaming (SSE)"},{"name":"Webhooks","description":"GitLab webhook handlers for GitOps"},{"name":"traces","description":"Pipeline monitoring and tracing"}]}