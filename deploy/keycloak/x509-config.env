# =============================================================================
# Keycloak X509 Certificate Lookup SPI Configuration (CAB-867)
# =============================================================================
# Enables Keycloak to read client certificates from HTTP headers
# set by a reverse proxy (F5, nginx) that terminates mTLS.
#
# Provider: nginx (also works with F5/HAProxy that use the same header pattern)
# See: https://www.keycloak.org/server/all-provider-config#_x509cert_lookup
# =============================================================================

# Use the nginx provider to read certs from HTTP headers
KC_SPI_X509CERT_LOOKUP_PROVIDER=nginx

# Header containing the URL-encoded PEM client certificate
KC_SPI_X509CERT_LOOKUP_NGINX_SSL_CLIENT_CERT=SSL_CLIENT_CERT

# Header prefix for certificate chain (SSL_CLIENT_CERT_CHAIN_0, _1, etc.)
KC_SPI_X509CERT_LOOKUP_NGINX_SSL_CERT_CHAIN_PREFIX=SSL_CLIENT_CERT_CHAIN

# Maximum depth of certificate chain to read from headers
KC_SPI_X509CERT_LOOKUP_NGINX_CERTIFICATE_CHAIN_LENGTH=1
