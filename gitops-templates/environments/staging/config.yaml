# Staging Environment Configuration
# Inherits from: _defaults.yaml
#
# Available variables (from _defaults.yaml):
#   - ${infrastructure.BASE_DOMAIN}: Base domain for the platform
#   - ${services.*}: Service URLs (gateway, portal, etc.)
#   - ${variables.*}: Default variable values
#
environment: staging
description: Staging environment for pre-production validation

# Environment-specific overrides
variables:
  # Domain configuration
  ENV_DOMAIN: "staging.${BASE_DOMAIN:apim.cab-i.com}"
  GATEWAY_URL: "https://gateway.staging.${BASE_DOMAIN:apim.cab-i.com}"
  PORTAL_URL: "https://portal.staging.${BASE_DOMAIN:apim.cab-i.com}"
  KEYCLOAK_URL: "https://auth.${BASE_DOMAIN:apim.cab-i.com}"
  CONTROL_PLANE_API_URL: "https://api.${BASE_DOMAIN:apim.cab-i.com}"

  # Backend configuration (moderate)
  BACKEND_TIMEOUT: "30"
  BACKEND_RETRY_COUNT: "3"

  # Rate limiting (moderate)
  RATE_LIMIT_REQUESTS: "500"
  RATE_LIMIT_WINDOW: "60"
  RATE_LIMIT_BURST: "50"

  # Logging
  LOG_LEVEL: "INFO"
  LOG_FORMAT: "json"

  # Security (moderate)
  CORS_ALLOWED_ORIGINS: "https://*.staging.${BASE_DOMAIN:apim.cab-i.com}"

  # Monitoring (moderate sampling)
  METRICS_ENABLED: "true"
  TRACING_ENABLED: "true"
  TRACING_SAMPLE_RATE: "0.5"

# Staging-specific settings
settings:
  auto_deploy: false
  require_approval: true
  approval_roles:
    - devops
    - tenant-admin
  allow_untested_apis: false
  auto_sync: true

# Vault path prefix for this environment
vault:
  enabled: ${VAULT_ENABLED:false}
  path_prefix: "secret/data/staging"

# Kubernetes configuration
kubernetes:
  cluster_url: "${K8S_CLUSTER_URL:https://kubernetes.default.svc}"
  namespace_suffix: "staging"
