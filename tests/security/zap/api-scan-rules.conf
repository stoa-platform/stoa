# =============================================================================
# OWASP ZAP API Scan Rules Configuration
# =============================================================================
# STOA Platform - Phase 9.5 Production Readiness
# Rules file for API-specific scanning
# =============================================================================

# Rule configuration format:
# [rule_id]	[IGNORE/WARN/FAIL]	[url_regex (optional, use empty for all)]

# === Information Disclosure ===
# Cookie without Secure flag
10011	WARN	(http.*|https.*)
# Cookie without HttpOnly flag
10010	WARN	(http.*|https.*)
# Cross-Domain JavaScript Source File Inclusion
10017	WARN	(http.*|https.*)

# === Security Headers ===
# Content-Type Options (X-Content-Type-Options)
10021	WARN	(http.*|https.*)
# Content Security Policy
10038	WARN	(http.*|https.*)
# X-Frame-Options Header
10020	WARN	(http.*|https.*)
# Strict-Transport-Security
10035	FAIL	(http.*|https.*)

# === Session Management ===
# Session ID in URL Rewrite
3	FAIL	(http.*|https.*)
# Weak Authentication Method
10105	FAIL	(http.*|https.*)

# === Injection ===
# SQL Injection
40018	FAIL	(http.*|https.*)
# Cross-Site Scripting (Reflected)
40012	FAIL	(http.*|https.*)
# Cross-Site Scripting (Persistent)
40014	FAIL	(http.*|https.*)
# OS Command Injection
90020	FAIL	(http.*|https.*)
# Server Side Include
40009	FAIL	(http.*|https.*)
# External Redirect
20019	WARN	(http.*|https.*)
# LDAP Injection
40015	FAIL	(http.*|https.*)

# === Sensitive Data ===
# Private IP Disclosure
2	WARN	(http.*|https.*)
# Information Disclosure - Debug Error Messages
10023	WARN	(http.*|https.*)
# Information Disclosure - Sensitive Info in URL
10024	WARN	(http.*|https.*)
# Information Disclosure - Sensitive Info in HTTP Referrer
10025	WARN	(http.*|https.*)

# === CORS ===
# CORS Misconfiguration
40040	FAIL	(http.*|https.*)

# === Authentication ===
# Insecure HTTP Method
90028	WARN	(http.*|https.*)
# Username Enumeration (too noisy, handle separately)
40025	IGNORE	(http.*|https.*)

# === API-Specific ===
# Missing Anti-CSRF Tokens (APIs use Bearer tokens)
10202	IGNORE	(http.*|https.*)
# Application Error Disclosure
90022	WARN	(http.*|https.*)
# Server Leaks Version Info
10036	WARN	(http.*|https.*)
# Timestamp Disclosure
10096	IGNORE	(http.*|https.*)

# === False Positives for STOA ===
# Cookie set without SameSite attribute (handled by Keycloak)
10054	IGNORE	(http.*|https.*)
