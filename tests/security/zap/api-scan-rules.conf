# =============================================================================
# OWASP ZAP API Scan Rules Configuration
# =============================================================================
# STOA Platform - Phase 9.5 Production Readiness
# Rules file for API-specific scanning
# =============================================================================

# Rule configuration format:
# [rule_id]  [IGNORE/WARN/FAIL]  [confidence (optional)]

# === Information Disclosure ===
# Cookie without Secure flag
10011	WARN
# Cookie without HttpOnly flag
10010	WARN
# Cross-Domain JavaScript Source File Inclusion
10017	WARN

# === Security Headers ===
# Content-Type Options (X-Content-Type-Options)
10021	WARN
# Content Security Policy
10038	WARN
# X-Frame-Options Header
10020	WARN
# Strict-Transport-Security
10035	FAIL

# === Session Management ===
# Session ID in URL Rewrite
3	FAIL
# Weak Authentication Method
10105	FAIL

# === Injection ===
# SQL Injection
40018	FAIL
# Cross-Site Scripting (Reflected)
40012	FAIL
# Cross-Site Scripting (Persistent)
40014	FAIL
# OS Command Injection
90020	FAIL
# Server Side Include
40009	FAIL
# External Redirect
20019	WARN
# LDAP Injection
40015	FAIL

# === Sensitive Data ===
# Private IP Disclosure
2	WARN
# Information Disclosure - Debug Error Messages
10023	WARN
# Information Disclosure - Sensitive Info in URL
10024	WARN
# Information Disclosure - Sensitive Info in HTTP Referrer
10025	WARN

# === CORS ===
# CORS Misconfiguration
40040	FAIL

# === Authentication ===
# Insecure HTTP Method
90028	WARN
# Username Enumeration
40025	IGNORE	# Too noisy, handle separately

# === API-Specific ===
# Missing Anti-CSRF Tokens (APIs use Bearer tokens)
10202	IGNORE
# Application Error Disclosure
90022	WARN
# Server Leaks Version Info
10036	WARN
# Timestamp Disclosure
10096	IGNORE

# === False Positives for STOA ===
# Cookie set without SameSite attribute (handled by Keycloak)
10054	IGNORE
# Absence of Anti-CSRF Tokens (Bearer token used instead)
10202	IGNORE
